set(CMAKE_MODULE_PATH_OLD ${CMAKE_MODULE_PATH})
set(CMAKE_MODULE_PATH "")
find_package(OpenSSL)
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH_OLD})
unset(CMAKE_MODULE_PATH_OLD)
if (OPENSSL_FOUND)
  # FreeRDP has a bug in makecert CMakeLists.txt
  # OPENSSL_CRYPTO_LIBRARIES should be OPENSSL_CRYPTO_LIBRARY
  message(STATUS "OPENSSL_LIBRARIES: ${OPENSSL_LIBRARIES}")
  list(APPEND OPENSSL_CRYPTO_LIBRARY "-ldl")
  message(STATUS "OPENSSL_CRYPTO_LIBRARY: ${OPENSSL_CRYPTO_LIBRARY}")
  set(OPENSSL_CRYPTO_LIBRARIES ${OPENSSL_CRYPTO_LIBRARY})
  message(STATUS "OPENSSL_CRYPTO_LIBRARY: ${OPENSSL_CRYPTO_LIBRARY}")
  #set(OPENSSL_LIBRARIES ${OPENSSL_LIBRARIES} -ldl)
endif()
